<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Messy Data into Insights</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Hakim El Hattab">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="reveal.js/css/reveal.css">

    <!--<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">-->
    <!--<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">-->
    <!--<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">-->
    <link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">


  <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">
    <style>
        /*pre code {*/
            /*display: block;*/
            /*padding: 0.5em;*/
            /*background: #FFFFFF !important;*/
            /*color: #000000 !important;*/
        /*}*/

        .right-img {
            margin-left: 10px !important;
            float: right;
            height: 500px;
        }
        .todo:before {
            content: 'TODO: ';
        }
        .todo {
            color: red !important;
        }
        code span.line-number {
            color: lightcoral;
        }
        .reveal pre code {
            max-height: 1000px !important;
        }
        img {
            border: 0 !important;
            box-shadow:0 0 0 0 !important;
        }
        .reveal {
            -ms-touch-action: auto !important;
            touch-action: auto !important;
        }
        .reveal h2,
        .reveal h3 {
          letter-spacing: 2px;
        }

        .reveal h2 {
          font-family: 'Amiri', serif;
          /* font-family: 'Times New Roman', Times, serif; */
          font-weight: bold;
          font-style: italic;
          letter-spacing: -2px;
          text-transform: none !important;
        }

        .reveal em {
          font-weight: bold;
        }
        .reveal .step-subtitle h1 {
          letter-spacing: 1px;
        }
        .reveal .step-subtitle h2,
        .reveal .step-subtitle h3 {
          text-transform: none;
          font-style: italic;
          font-weight: normal;
          /* font-weight: 400; */
          /* font-family: 'Amiri', serif; */
          font-family: 'Lobster', serif;
          letter-spacing: 1px;
          color: #2aa198;
          text-decoration: underline;
        }

    </style>


    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'reveal.js/css/print/pdf.css' : 'reveal.js/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <!--[if lt IE 9]>
    <script src="reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">
    <div class="slides">

<!--
Todo:
Base on:
- https://github.com/DJCordhose/big-data-visualization/blob/gh-pages/2016_odsc_london.html
- http://djcordhose.github.io/big-data-visualization/code/dc-911-map.html

Title: 'Turning Messy Data into Insights - A case study on American Domestic Flight Data'

Abstract
* How to check plausibility of your data?
* How do you find out what might be interesting?
* How to interactively explore your data?
* How to answer specific questions using visualization?

Bio

 Independent Data Science and Machine Learning Consultant

Content
```
ML is the race car
Data is the fuel
```

Consider
- Adding tsne.js
- https://github.com/bloomberg/bqplot
- https://plot.ly/products/dash/

-->

                <section data-markdown class="preparation">
            <script type="text/template">
## Preparation
- Start ES and Kibana on AWS GPU
- Run incremntell import as shown in last step of ```import.ipynb```

            </script>
        </section>

        <section>
            <h2>Turning Messy Data into Insights</h2>
            <h3>A case study on American Domestic Flight Data</h3>
                <h4><a href="http://zeigermann.eu">Oliver Zeigermann</a> / <a href="http://twitter.com/djcordhose">@DJCordhose</a>
                </h4>
            <p><small><a href="http://bit.ly/data-insights-ml-101">
                http://bit.ly/data-insights-ml-101
            </a></small></p>
        </section>

        <section class="todo">
            <pre>
- Talk as PDF until Fri 13th
- add screenshots from Kibana Dashboard
- add unsupervised learning results from notebook
- add locations as lat lon in import?
  - resolve using airports_geo_data.csv over Origin and Destination
            </pre>
        </section>

        <section data-transition="zoom">
            <a href="https://twitter.com/Creatuluw/status/770519427771170816" target="_blank">
                <img src="img/dataviz//twitter-creatuluw.png">
            </a>
            <p><small>
                <a href="https://twitter.com/Creatuluw/status/770519427771170816" target="_blank">
                    https://twitter.com/Creatuluw/status/770519427771170816
                </a>
                </small></p>
        </section>

        <section>
            <h2>A journey through exploring <em>all</em> domestic US flights</h2>
            <h2>from 2000 to 2002</h2>
            <img src="img/airline-pictures/a26.jpg" height="200px">
            <p><a target="_blank" href="http://stat-computing.org/dataexpo/2009/">http://stat-computing.org/dataexpo/2009/</a></p>
        </section>

        <section>
            <h2>The raw data (per year)</h2>
            <p>approx. 6 million data sets</p>
            <pre><code contenteditable data-trim class="nohighlight">
> wc -l 2001.csv
5967781 2001.csv
            </code></pre>
            <p>approx. 600 MB of data</p>
            <pre><code contenteditable data-trim class="nohighlight">
> ls -hl 2001.csv
573M Jan 10  2016 2001.csv
            </code></pre>
            <p>29 colums, data has gaps, but looks consistent</p>
            <pre><code contenteditable data-trim class="nohighlight">
> head 2001.csv
Year,Month,DayofMonth,DayOfWeek,DepTime,CRSDepTime,ArrTime,CRSArrTime,UniqueCarrier,FlightNum,TailNum,ActualElapsedTime,CRSElapsedTime,AirTime,ArrDelay,DepDelay,Origin,Dest,Distance,TaxiIn,TaxiOut,Cancelled,CancellationCode,Diverted,CarrierDelay,WeatherDelay,NASDelay,SecurityDelay,LateAircraftDelay
2001,1,17,3,1806,1810,1931,1934,US,375,N700��,85,84,60,-3,-4,BWI,CLT,361,5,20,0,NA,0,NA,NA,NA,NA,NA
2001,1,18,4,1805,1810,1938,1934,US,375,N713��,93,84,64,4,-5,BWI,CLT,361,9,20,0,NA,0,NA,NA,NA,NA,NA
2001,1,19,5,1821,1810,1957,1934,US,375,N702��,96,84,80,23,11,BWI,CLT,361,6,10,0,NA,0,NA,NA,NA,NA,NA
2001,1,20,6,1807,1810,1944,1934,US,375,N701��,97,84,66,10,-3,BWI,CLT,361,4,27,0,NA,0,NA,NA,NA,NA,NA</code></pre>
        </section>

        <section>
            <h2>No specific task or question</h2>
            <h3>Exploring what just might be interesting</h3>
            <h3>Finding the unknown unknowns</h3>
            <div>
                <img src="img/icons/question-mark.jpg">
            </div>
        </section>

        <section>
            <h2 style="margin-top: -10px"><small>Why not just load it into Excel and wing it?</small></h2>
            <ul style="margin-top: -60px">
                <li class="fragment">Excel (2011 Mac): <em style="color: red">truncates</em>
                    <ul>
                        <li>loads data relatively fast
                        <li>truncates after 1M lines
                    </ul>
                </li>
                <li class="fragment">Google Sheets: <em style="color: red">nope</em>
                    <ul>
                        <li>limited to 2.000.000 cells (not lines)
                        <li>does not load data at all
                    </ul>
                </li>
                <li class="fragment">Numbers (Mac): <em style="color: red">truncates</em>
                    <ul>
                        <li>loading takes long
                        <li>truncates after 64k lines
                    </ul>
                </li>
                <li class="fragment">Emacs: <em style="color: red">Low-level operations possible</em>
                    <ul>
                        <li>very fast and almost no memory overhead
                        <li>just a text editor
                    </ul>
                </li>
            </ul>
        </section>

        <section>
            <h2>Challenge</h2>
            <p class="fragment">Handling large amounts of data while maintaining the interactivity and the intuitive UI</p>
            <p class="fragment">Like: benefits of Excel and Access at the same time</p>
        </section>

        <section>
            <a href="https://twitter.com/DJCordhose/status/784683545457467392" target="_blank">
                <img src="img/dataviz/twitter-bottleneck.png" height="600px">
            </a>
            <p><small><a href="https://twitter.com/DJCordhose/status/784683545457467392" target="_blank">
                https://twitter.com/DJCordhose/status/784683545457467392</a></small></p>
        </section>
        <section>
            <h2>The Journey</h2>
            <h3 class="fragment">Making sense of the data step by step</h3>
            <h3 class="fragment">All software shown here is Open Source and Free of Charge</h3>
        </section>

        <section>
            <h2>Step I: Statistical pre-analysis to learn about data</h2>
            <p style="color: red"><em>Caution</em>: Preparing and even collecting data already is interpretation</p>
            <ul>
                <li>What is the nature of the data (e.g. time series data)?</li>
                <li>Does the data look plausible?</li>
                <li>What visualizations seem most promising?</li>
            </ul>
        </section>

        <section>
            <h3>Correlations (r)</h3>
            <div class="fragment">
                <img src="img/flight-analysis/corr.png" height="500px">
                <p><small>Interesting: Distance / Origin to Unique Carrier</small></p>
            </div>
        </section>

        <section>
            <h2><small>Pearson's r: Linear Correlation</small></h2>
            <p><em>Pearson's r</em> is a measure of the degree of <em>linear(!)</em> dependence between two variables</p>
            <!--<a target="_blank" href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient#/media/File:Correlation_coefficient.png">-->
                <!--<img src="Correlation_examples2.svg" height="400px">-->
            <!--</a>-->
            <!--<p><small><a href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient" target="_blank">-->
                <!--https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient-->
            <!--</a></small></p>-->
            <a target="_blank" href="https://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient#/media/File:Correlation_coefficient.png">
            <img src="img/Correlation_coefficient.png">
            </a>
            <p><small>By <a href="//commons.wikimedia.org/wiki/User:Kiatdd" title="User:Kiatdd">Kiatdd</a> - <span class="int-own-work" lang="en">Own work</span>, <a href="http://creativecommons.org/licenses/by-sa/3.0" title="Creative Commons Attribution-Share Alike 3.0">CC BY-SA 3.0</a>, https://commons.wikimedia.org/w/index.php?curid=37108966            </a></small></p>
        </section>

        <section>
            <h2>Need to look at the individual figures</h2>
        </section>

        <section>
            <h3>Arrival Time to Departure Time</h3>
            <div class="fragment">
                <img src="img/flight-analysis/ArrTime_DepTime.png" height="500px">
                <p><small>Pearson's r: 0.77, plausible but trivial</small></p>
            </div>
        </section>

        <section>
            <h3>Origin to Unique Carrier</h3>

            <div class="fragment">
                <img src="img/flight-analysis/Origin__UniqueCarrier_.png" height="500px">
            </div>
        </section>

        <section  data-transition="none">
            <h3>Origin to Unique Carrier</h3>

            <div>
                <img src="img/flight-analysis/Origin__UniqueCarrier_ATL.png" height="500px">
                <p><small>
                    <!--0 = AA(American Airlines),-->
                    <em>4 = (DL) Delta</em>
                    <!--, 7 = NW (Northwest), 11 = WN (Southwest)-->
                </small></p>
                <!--Answer DL in D3 part: that is ATL (Atlanta) -->
            </div>
        </section>

        <section>
            <h3>Distance to Unique Carrier</h3>
            <div class="fragment">

            <img src="img/flight-analysis/Distance_UniqueCarrier_.png" height="500px">
                </div>
        </section>

        <section data-transition="none">
            <h3>Distance to Unique Carrier</h3>
            <div>

                <img src="img/flight-analysis/Distance_UniqueCarrier_AQ.png" height="500px">
                <p><small>
                    <em>1 = AQ (Aloha Airlines)</em>
                    <!--, 6 = MQ (Envoy Air), 9 = UA (United), 10 = US (US Airways)-->
                </small></p>
                <!--Answer AQ in D3 part: mainly between Hawaii and California -->
            </div>
        </section>

        <section>
            <h2><small>Unsupervised Machine Learning can also help</small></h2>
            <img src="img/mc-learning.jpg" height="450px">
            <p><small>What do you mean by Machine Learning? <a href="http://www.techjini.com/blog/machine-learning/" target="_blank">http://www.techjini.com/blog/machine-learning/</a>
            </small></p>
        </section>

        <section>
            <h2><small>Results of Analysis</small></h2>
            <ul>
                <li>A really large set of data
                <li>Data looks plausible
                <li>Many missing values
                <li>Contains obvious correlations
                <li>But also contains non-trivial correlations
                <li>Has timestamps
                <li>Storing and analysing as time series data sounds promising
            </ul>
            <br>
            <br>
            <h2 class="fragment"><small>Bottom line: not an easy, but interesting data set</small></h2>
        </section>

        <section>
            <h2>Step II: Interactively Exploration</h2>
            <p>Loading all the data into a database and query it interactively</p>
        </section>

        <section>
            <h2><small>Your #data from another perspective with #dataviz</small></h2>
            <div>
                <a href="https://twitter.com/Creatuluw/status/749151998415634432" target="_blank">
                <img src="img/dataviz/cat-upside-down.jpg" height="450px"
                     style="float: left; padding-right: 50px; padding-left: 150px">
                    </a>
                    <a href="https://twitter.com/planetepics/status/914792139309150208" target="_blank">
                <img src="img/dataviz/dataviz-cat.jpg" height="450px" style="float: left">
                </a>

            </div>
            <p style="clear: both"><small><a target="_blank" href="https://twitter.com/Creatuluw/status/749151998415634432">
                https://twitter.com/Creatuluw/status/749151998415634432</a>
                <br>
                <a href="https://twitter.com/planetepics/status/914792139309150208" target="_blank">
                    https://twitter.com/planetepics/status/914792139309150208
                </a>
                </small></p>
        </section>

        <section>
            <h3>Checking time series data for the first time</h3>
            <div class="fragment">
                <p>using Kibana adhoc queries</p>
                <a href="http://localhost:5601/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:'2001-08-31T22:00:00.000Z',mode:quick,to:'2001-09-30T22:00:00.000Z'))&_a=(columns:!(Cancelled,Origin,Dest,UniqueCarrier),filters:!(),index:expo2009_airline,interval:h,query:(query_string:(analyze_wildcard:!t,query:'*')),sort:!('@timestamp',desc),vis:(aggs:!((params:(field:ArrDelay,orderBy:'2',size:20),schema:segment,type:terms),(id:'2',schema:metric,type:count)),type:histogram))&indexPattern=expo2009_airline&type=histogram" target="_blank">
                    <img src="screenshot_kibana_discover.png">
                </a>
                <p>Demo: filter for <em>'Cancelled:false'</em></p>
                <p><small>Interactive Dashboards also possible</small></p>
            </div>
        </section>

        <section>
            <h2>Kibana</h2>
            <ul>
                <li>generic frontend for Elasticsearch
                <li>browser based
                <li>allows for dashboards
                <li>also allows to make arbitrary adhoc queries
            </ul>
        </section>

        <section>
            <h2>Step III: Data Exploration Examples</h2>
            <h3>Coming back to questions from analysis in first and second part</h3>
            <p>This requires domain knowledge and interpretation</p>
        </section>

        <section>
            <h2><small>What is the recurring dent in the histogram?</small></h2>
        </section>

        <section>
            <h2><small>What are the origins of Delta flights to STL (St Louis)? Why?</small></h2>
        </section>

        <section>
            <h2><small>Why only short flight distances for Carrier Aloha Airlines (AQ)?</small></h2>
            <img src="img/flight-analysis/Distance_UniqueCarrier_AQ.png" height="500px">
            <!--<p><small><em>1 = AQ (Aloha Airlines)</em>, 6 = MQ (Envoy Air), 9 = UA (United), 10 = US (US Airways)</small></p>-->
            <!--Answer AQ in D3 part: mainly between Hawaii and California -->
        </section>

        <section>
            <h3>Answer</h3>
            <div>
                <a target="_blank" href="code/dc-911-map.html"><img src="screenshot_aq.png" height="400px"></a>
            </div>
            <p class="fragment"><a href="https://en.wikipedia.org/wiki/Aloha_Airlines" target="_blank">
                Aloha Airlines (AQ) mainly flies between Hawaii and West Coast (California/Nevada)
            </a></p>
        </section>


        <section>
            <h2><small>What is the prominent Origin for Carrier Delta (DL)?</small></h2>
            <img src="img/flight-analysis/Origin__UniqueCarrier_ATL.png" height="500px">
            <!--<p><small>0 = AA(American Airlines), <em>4 = (DL) Delta</em>, 7 = NW (Northwest), 11 = WN (Southwest)</small></p>-->
            <!--Answer DL in D3 part: that is ATL (Atlanta) -->
        </section>

        <section>
            <h3>Answer</h3>
            <div>
                <a target="_blank" href="code/dc-911-map.html"><img src="screenshot_ATL.png" height="400px"></a>
            </div>
            <p class="fragment"><a href="https://en.wikipedia.org/wiki/Delta_Air_Lines" target="_blank">
                Delta (DL) mainly flies from Atlanta (ATL) its headquarter and largest hub
            </a></p>
        </section>

        <section>
            <h2>Tools Used</h2>
            <p>There are many tools for these task, you can choose others</p>
            <ul>
                <li>Basic Processing: UNIX tools
                <li>Cleaning and Import: Dask (Python)
                <li>Statistical pre-analysis: Pandas (Python)
                <li>Display and Interactive Filtering: Elasticsearch and Kibana
            </ul>
        </section>

        <section>
            <h2>Wrapup</h2>
            <ul>
                <li class="fragment">Statistic Analysis on Samle Code can give first insights
                <li class="fragment">Exploring Data Interactively lets you find most interesting relationships
                <li class="fragment">Unsupervised Machine Learning can find more interesting details
                <li class="fragment">Answering the "why" involves domain knowledge and interpretation
                <li class="fragment">Interactive, visual experiments also help with interpretation of data
                <li class="fragment">Interpretation and understanding is the prerequisite to action
            </ul>
            <p>Slides: <a href="http://bit.ly/data-insights-ml-101">
                http://bit.ly/data-insights-ml-101</a></p>
            <p>Ping me for questions / help / comments: <a href="http://zeigermann.eu">http://zeigermann.eu</a> / <a href="http://twitter.com/djcordhose">@DJCordhose</a></p>
        </section>
    </div>

</div>

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>
<script src="lib/jquery-2.2.4.js"></script>

<script>
    //    $('section').attr('data-background-image', "backgrounds/dark-saddle.jpg")
//    $('section').attr('data-background-image', "backgrounds/dark-blue.jpg")
$('section').attr('data-background-image', "backgrounds/light-chalk.jpg");
//    $('section').attr('data-background-image', "backgrounds/dark-blur.jpg")
    //$('section').attr('data-background-image', "backgrounds/dark-case.jpg")
    //$('section').attr('data-background-image', "backgrounds/dark-grid.jpg")
    //    $('section').attr('data-background-image', "backgrounds/dark-fish.jpg")
</script>
<script>
    if (window.location.hostname.indexOf('localhost') !== -1) {
    } else {
        // only applies to public version
        $('.preparation').remove();
    }
    Reveal.addEventListener( 'ready', function( event ) {
        if (window.location.hostname.indexOf('localhost') !== -1) {
            // only applies to presentation version
            Reveal.configure({ controls: false });
        } else {
            // only applies to public version
            $('.fragment').removeClass('fragment');
        }
        // applies to all versions
        $('code').addClass('line-numbers');
        // $('.fragment').removeClass('fragment');
    } );
</script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'fade', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: 'reveal.js/lib/js/classList.js', condition: function () {
                return !document.body.classList;
            }
            },
            {
                src: 'reveal.js/plugin/markdown/marked.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/markdown/markdown.js', condition: function () {
                return !!document.querySelector('[data-markdown]');
            }
            },
            {
                src: 'reveal.js/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code');
            }, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            },
            {src: 'reveal.js/plugin/zoom-js/zoom.js', async: true},
            {src: 'reveal.js/plugin/notes/notes.js', async: true},
            // https://github.com/mikemiles86/reveal-line-numbers
            {src: 'lib/js/line-numbers.js'}
        ]
    });

</script>

</body>
</html>
